{"version":3,"file":"commonHelpers2.js","sources":["../src/js/02-timer.js"],"sourcesContent":["import flatpickr from 'flatpickr';\nimport 'flatpickr/dist/flatpickr.min.css';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst elems = {\n    dateInput: document.querySelector('input#datetime-picker'),\n    btnStartTimer: document.querySelector('button[data-start]'),\n    timerDelay: 1000,\n};\n\nlet intervalId = null;\nlet selectedDate = null;\nlet currentDate = null;\n\nconst calendar = elems.dateInput;\nconst startBtn = elems.btnStartTimer;\nstartBtn.disabled = true;\n\niziToast.info({\n    title: 'Hello!',\n    message: 'Choose a date and click on start',\n    timeout: 8000,\n    position: 'topRight',\n});\n\nflatpickr(calendar, {\n    enableTime: true,\n    time_24hr: true,\n    defaultDate: new Date(),\n    minuteIncrement: 1,\n    onClose(selectedDates) {\n        if (selectedDates[0].getTime() < Date.now()) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Ooops...Please, choose a date in the future',\n                timeout: 8000,\n                position: 'topRight',\n            });\n        } else {\n            iziToast.success({\n                title: 'Next',\n                message: 'Click on start!',\n                timeout: 8000,\n                position: 'topRight',\n            });\n            startBtn.disabled = false;\n            const setTimer = () => {\n                selectedDate = selectedDates[0].getTime();\n                timer.start();\n            };\n\n            startBtn.addEventListener('click', setTimer);\n        }\n    },\n});\nconst timer = {\n    rootSelector: document.querySelector('.timer'),\n    start() {\n        intervalId = setInterval(() => {\n            startBtn.disabled = true;\n            calendar.disabled = true;\n            currentDate = Date.now();\n            const delta = selectedDate - currentDate;\n\n            if (delta <= 0) {\n                this.stop();\n                iziToast.success({\n                    title: 'Congratulation!',\n                    message: 'Timer stopped! If you want to start timer, choose a date and click on start or reload this page',\n                    timeout: 8000,\n                    position: 'center',\n                });\n                return;\n            }\n            const { days, hours, minutes, seconds } = this.convertMs(delta);\n            this.rootSelector.querySelector('[data-days]').textContent =\n                this.addLeadingZero(days);\n            this.rootSelector.querySelector('[data-hours]').textContent =\n                this.addLeadingZero(hours);\n            this.rootSelector.querySelector('[data-minutes]').textContent =\n                this.addLeadingZero(minutes);\n            this.rootSelector.querySelector('[data-seconds]').textContent =\n                this.addLeadingZero(seconds);\n        }, elems.timerDelay);\n    },\n\n    stop() {\n        clearInterval(intervalId);\n        this.intervalId = null;\n        startBtn.disabled = true;\n        calendar.disabled = false;\n    },\n\n    convertMs(ms) {\n        const second = 1000;\n        const minute = second * 60;\n        const hour = minute * 60;\n        const day = hour * 24;\n\n        const days = this.addLeadingZero(Math.floor(ms / day));\n        const hours = this.addLeadingZero(Math.floor((ms % day) / hour));\n        const minutes = this.addLeadingZero(\n            Math.floor(((ms % day) % hour) / minute)\n        );\n        const seconds = this.addLeadingZero(\n            Math.floor((((ms % day) % hour) % minute) / second)\n        );\n\n        return { days, hours, minutes, seconds };\n    },\n\n    addLeadingZero(value) {\n        return String(value).padStart(2, 0);\n    },\n};"],"names":["elems","intervalId","selectedDate","currentDate","calendar","startBtn","iziToast","flatpickr","selectedDates","setTimer","timer","delta","days","hours","minutes","seconds","ms","value"],"mappings":"+IAKA,MAAMA,EAAQ,CACV,UAAW,SAAS,cAAc,uBAAuB,EACzD,cAAe,SAAS,cAAc,oBAAoB,EAC1D,WAAY,GAChB,EAEA,IAAIC,EAAa,KACbC,EAAe,KACfC,EAAc,KAElB,MAAMC,EAAWJ,EAAM,UACjBK,EAAWL,EAAM,cACvBK,EAAS,SAAW,GAEpBC,EAAS,KAAK,CACV,MAAO,SACP,QAAS,mCACT,QAAS,IACT,SAAU,UACd,CAAC,EAEDC,EAAUH,EAAU,CAChB,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACjB,QAAQI,EAAe,CACnB,GAAIA,EAAc,GAAG,QAAO,EAAK,KAAK,MAClCF,EAAS,MAAM,CACX,MAAO,QACP,QAAS,8CACT,QAAS,IACT,SAAU,UAC1B,CAAa,MACE,CACHA,EAAS,QAAQ,CACb,MAAO,OACP,QAAS,kBACT,QAAS,IACT,SAAU,UAC1B,CAAa,EACDD,EAAS,SAAW,GACpB,MAAMI,EAAW,IAAM,CACnBP,EAAeM,EAAc,GAAG,QAAO,EACvCE,EAAM,MAAK,CAC3B,EAEYL,EAAS,iBAAiB,QAASI,CAAQ,CAC9C,CACJ,CACL,CAAC,EACD,MAAMC,EAAQ,CACV,aAAc,SAAS,cAAc,QAAQ,EAC7C,OAAQ,CACJT,EAAa,YAAY,IAAM,CAC3BI,EAAS,SAAW,GACpBD,EAAS,SAAW,GACpBD,EAAc,KAAK,MACnB,MAAMQ,EAAQT,EAAeC,EAE7B,GAAIQ,GAAS,EAAG,CACZ,KAAK,KAAI,EACTL,EAAS,QAAQ,CACb,MAAO,kBACP,QAAS,kGACT,QAAS,IACT,SAAU,QAC9B,CAAiB,EACD,MACH,CACD,KAAM,CAAE,KAAAM,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,EAAK,KAAK,UAAUJ,CAAK,EAC9D,KAAK,aAAa,cAAc,aAAa,EAAE,YAC3C,KAAK,eAAeC,CAAI,EAC5B,KAAK,aAAa,cAAc,cAAc,EAAE,YAC5C,KAAK,eAAeC,CAAK,EAC7B,KAAK,aAAa,cAAc,gBAAgB,EAAE,YAC9C,KAAK,eAAeC,CAAO,EAC/B,KAAK,aAAa,cAAc,gBAAgB,EAAE,YAC9C,KAAK,eAAeC,CAAO,CAC3C,EAAWf,EAAM,UAAU,CACtB,EAED,MAAO,CACH,cAAcC,CAAU,EACxB,KAAK,WAAa,KAClBI,EAAS,SAAW,GACpBD,EAAS,SAAW,EACvB,EAED,UAAUY,EAAI,CAMV,MAAMJ,EAAO,KAAK,eAAe,KAAK,MAAMI,EAAK,KAAG,CAAC,EAC/CH,EAAQ,KAAK,eAAe,KAAK,MAAOG,EAAK,MAAO,IAAI,CAAC,EACzDF,EAAU,KAAK,eACjB,KAAK,MAAQE,EAAK,MAAO,KAAQ,GAAM,CACnD,EACcD,EAAU,KAAK,eACjB,KAAK,MAASC,EAAK,MAAO,KAAQ,IAAU,GAAM,CAC9D,EAEQ,MAAO,CAAE,KAAAJ,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACzC,EAED,eAAeE,EAAO,CAClB,OAAO,OAAOA,CAAK,EAAE,SAAS,EAAG,CAAC,CACrC,CACL"}